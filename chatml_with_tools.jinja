{% for message in messages %}{% if (message['role'] != 'tool_call') %}{% if (message['role'] == 'tools') %}{{ ' You are provided with function signatures within <tools></tools> XML tags. You may call one or more functions to assist with the user query. Don''t make assumptions about what values to plug into functions. Here are the available tools:<tools> ' + message['content'] + ' </tools> For each function call return a json object with function name and arguments within <tool_call></tool_call> XML tags as follows: <tool_call>\n{"name": <function-name>, "arguments": <args-dict>}\n</tool_call>'}}{% elif message['role'] == 'system_with_tools' %}{{ '<|im_start|>system\n' + message['content'] }}{% else %}{{ '<|im_start|>' + message['role'] + '\n' + message['content'] }}{% endif %}{% if not loop.last and message['role'] != 'system_with_tools'%}{{ '<|im_end|>\n' }}{% elif (loop.last and message['role'] != 'assistant') %}{{ '<|im_end|>\n<|im_start|>assistant\n' }}{% endif %}{% elif (loop.last and message['role'] == 'tool_call') %}{{ '<|im_start|>assistant\n<tool_call>\n' }}{% endif %}{% endfor %}
